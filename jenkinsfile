pipeline {
  agent any
  tools {
    terraform 'terraform-12'
  }

  stages {
    stage('Prepare') {
      steps {
        sh """
        terraform --version
        curl -LO https://get.golang.org/\$(uname)/go_installer && chmod +x go_installer && ./go_installer && rm go_installer
        ./precommit-linux-install.sh
        """
      }
    }

    stage('Run test') {
      steps {
          sh """
            cd example
            terraform init
            cd ..
            pre-commit run -a
          """
      }
    }
  }
}
